<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body>
<div class="container-fluid p-3 shadow bg-light border-bottom">
  <div class="d-flex justify-content-between align-items-center">
    <!-- Logo -->
    <h1 class="fw-semibold fs-3 mb-0">Event</h1>

    <!-- Mobile Toggle Button -->
    <button class="btn d-md-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#mobileMenu" aria-controls="mobileMenu">
      <i class="bi bi-list fs-1"></i>
    </button>

    <!-- Desktop Menu -->
    <div class="d-none d-md-flex flex-grow-1 justify-content-between align-items-center ms-4">
      
      <!-- Search Bar -->
      <div class="flex-grow-1 d-flex justify-content-start">
        <input 
          type="search" 
          name="search" 
          id="search" 
          class="form-control px-4 py-2 shadow-sm"
          placeholder="ðŸ” Search events, categories..."
          value="<%= events.qs_search || '' %>"
          style="max-width:400px; border-radius:50px; border:2px solid #ffb100; transition:all 0.3s ease;"
          onfocus="this.style.borderColor='#ff8800'; this.style.boxShadow='0 0 8px rgba(255,136,0,0.3)';"
          onblur="this.style.borderColor='#ffb100'; this.style.boxShadow='none';">
      </div>

      <!-- Center Navigation -->
      <div class="d-flex justify-content-center gap-4 mx-3">
        <% if (user && user.role === 'admin') { %>
          <a href="/create-event" class="nav-link fw-semibold text-primary">
            <i class="bi bi-plus-circle"></i> Create Event
          </a>
        <% } %>
        <% if(user){ %>
          <a href="/my-booking" class="nav-link fw-semibold text-dark">
            <i class="bi bi-ticket-perforated"></i> My Bookings
          </a>
        <% } %>
      </div>

      <!-- Auth Buttons -->
      <div class="d-flex justify-content-end gap-2">
        <% if (!user) { %>
          <a class="btn btn-outline-primary rounded-pill px-3" href="/login">Login</a>
          <a class="btn btn-primary rounded-pill px-3" href="/signup">Sign Up</a>
        <% } else { %>
          <a class="btn btn-danger rounded-pill px-3" href="/logout">Logout</a>
        <% } %>
      </div>
    </div>
  </div>

  <!-- Offcanvas for Mobile -->
  <div class="offcanvas offcanvas-end" tabindex="-1" id="mobileMenu" aria-labelledby="mobileMenuLabel">
    <div class="offcanvas-header">
      <h5 class="offcanvas-title" id="mobileMenuLabel">Menu</h5>
      <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
    </div>
    <div class="offcanvas-body d-flex flex-column gap-3">
      
      <!-- Search -->
      <input 
        type="search" 
        name="search" 
        id="search" 
        class="form-control px-3 py-2 mb-3"
        placeholder="ðŸ” Search events, categories..."
        value="<%= events.qs_search || '' %>"
        style="border-radius:50px; border:2px solid #ffb100;">

      <!-- Links -->
      <% if (user && user.role === 'admin') { %>
        <a href="/create-event" class="nav-link fw-semibold text-primary">
          <i class="bi bi-plus-circle"></i> Create Event
        </a>
      <% } %>
      <% if(user){ %>
        <a href="/my-booking" class="nav-link fw-semibold text-dark">
          <i class="bi bi-ticket-perforated"></i> My Bookings
        </a>
      <% } %>

      <!-- Auth Buttons -->
      <div class="mt-3 d-flex flex-column gap-2">
        <% if (!user) { %>
          <a class="btn btn-outline-primary rounded-pill px-3" href="/login">Login</a>
          <a class="btn btn-primary rounded-pill px-3" href="/signup">Sign Up</a>
        <% } else { %>
          <a class="btn btn-danger rounded-pill px-3" href="/logout">Logout</a>
        <% } %>
      </div>
    </div>
  </div>
</div>


</body>

<script>
  document.getElementById('search').addEventListener('change', function() {
    const tb_search = this.value.trim();
    const curURL = '/search';
    const queryParams = tb_search ? '?search=' + encodeURIComponent(tb_search) : '';

    window.location.href = curURL + queryParams;
  });

</script>

</html>