<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>My Bookings</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body { background: #f8f9fa; }
    .booking-card { border-radius: 15px; overflow: hidden; }
    .event-title { font-weight: bold; font-size: 1.3rem; }
    .badge-status { font-size: 0.9rem; padding: 5px 10px; }
    .price { font-size: 1.2rem; color: #28a745; font-weight: bold; }
  </style>
</head>
<body>
  <div class="container my-5">
    <h2 class="mb-4 text-center">üéüÔ∏è My Bookings</h2>

    <% if (bookings.length === 0) { %>
      <div class="alert alert-info text-center">You have no bookings yet.</div>
    <% } else { %>

      <div class="row g-4">
        <% bookings.forEach(b => { %>
          <div class="col-md-6 col-lg-4">
            <div class="card shadow booking-card">
              <div class="card-body">
                <!-- Event Title -->
                <h5 class="event-title"><%= b.event_title %></h5>
                <p class="text-muted mb-1">
                  <strong>Location:</strong> <%= b.event_location %>
                </p>

                <!-- Event Date & Time -->
                <p class="mb-2">
                  üìÖ <%= new Date(b.event_date).toDateString() %> |
                  ‚è∞ <%= b.event_time %>
                </p>

                <!-- Tickets Info -->
                <p class="mb-1">üé´ <strong>Tickets:</strong> <%= b.no_of_tickets %></p>
                <p class="price">‚Çπ<%= b.total_price %></p>

                <!-- Payment Status -->
                <% if (b.payment_status === 'paid') { %>
                  <span class="badge bg-success badge-status">Paid</span>
                <% } else if (b.payment_status === 'pending') { %>
                  <span class="badge bg-warning badge-status">Pending</span>
                <% } else { %>
                  <span class="badge bg-danger badge-status">Failed</span>
                <% } %>

                 <form action="/cancel-booking/<%= b.booking_id %>" method="POST" style="display:inline;">
                    <button type="submit" class="btn btn-danger btn-sm">Cancel Booking</button>
                </form>


                <!-- Booking Date -->
                <p class="mt-3 mb-0 text-muted">
                  <small>Booked On: <%= new Date(b.book_at).toLocaleString() %></small>
                </p>
              </div>
            </div>
          </div>
        <% }) %>
      </div>
      
    <% } %>
  </div>

</body>

<script src="https://cdn.jsdelivr.net/npm/darkmode-js/lib/darkmode-js.min.js"></script>
<script src="/darkMode/darkMode.js"></script>
</html>
